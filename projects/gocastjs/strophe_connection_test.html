<html lang="en"><!--manifest="cache-manifest.appcache">-->
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type" />
    <meta http-equiv="Cache-Control" content="no-store" />
    <meta http-equiv="Cache-Control" content="max-age = 0" />
    <meta http-equiv="Expires" content="-1" />
    <meta http-equiv="Pragma" content="no-cache" />
    <script type="text/javascript" src="js/jquery-1.8.1.js"></script>
    <script type="text/javascript" src="/scripts/strophe.js"></script>
    <script type="text/javascript" src="js/strophe_connection.js"></script>
    <script type="text/javascript">
      if (!window.console) {
        console = { log: function() {} };
      }
      $(document).ready(function() {
        var who;
          console.log('Getting started...');

          var con = new GoCastJS.StropheConnection({ boshurl: '/xmpp-httpbind',
                                                     xmppserver: 'dev.gocast.it',
                                                     statusCallback: function(status) {
            console.log('CALLBACK: ' + status);
            switch (status) {
              case Strophe.Status.CONNECTED:
                con.connection.send($pres());
                break;
              case Strophe.Status.ATTACHED:
                con.connection.send($pres());
                break;
            }

          }});

          if (con.hasSavedLoginInfo()) {
            who = con.autoConnect();
            if (who && who !== '') {
              console.log('**** AUTO_CONNECT started as: ' + who);
            }
          }
          else {
            console.log('REGULAR LOGIN - not automatic this time. No saved login info available.');
            // Test login with simple username
            con.connect({username: 'bobtest', password: '1234'});
            // Test login anonymously.
//            con.connect();
          }
      });
    </script>
    <title>Gocast.it</title>
  </head>

  <body>
    <h2>Testing connection. See console for output.</h2>
  </body>
</html>
