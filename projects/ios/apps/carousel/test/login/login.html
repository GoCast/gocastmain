<html>
  <head>
    <title>test</title>
    
    <link rel='stylesheet' href='http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.0/themes/cupertino/jquery-ui.css'>
    <script src='http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.js'></script>
    <script src='http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/jquery-ui.js'></script>
    <script src='jquery.base64.js'></script>
    <script src='strophejs-1.0.2/strophe.js'></script>
    <script src='strophejs-1.0.2/strophe.muc.js'></script>
    <script src='ibb.js'></script>
    <script src='callcast.js'></script>
  </head>
<body bgcolor=#cccccc>

Login

<script>
var app = {
  /**
   * Writes the specified log entry into the console HTML element, if
   * present. The meaning of logLevel is 1: debug, 2: info, 3:
   * warning, 4: error, 5: fatal. */
  log: function(logLevel, logMsg) {
    var labels = ['', 'DEBUG', 'INFO', 'WARNING', 'ERROR', 'FATAL'],
        now = new Date(),
        logText = now.toTimeString().split(' ')[0] + ' ' + labels[logLevel] + ' ' + logMsg,
        msg;
    if (window.console) {
      console[['', 'log', 'info', 'warn', 'error', 'error'][logLevel]](logText);
    }
    /*
     * For fatal errors pop-up an alert in addition to the console log
     * entry but do it only once, to avoid flooding the user with alerts. */
    if (logLevel >= 5 && !app.logFatalReported) {
      msg = 'FATAL ERROR\n\n' + logMsg;
      alert(msg);
      app.logFatalReported = true;
    }

    // <MANJESH>
    if ('undefined' !== typeof(Callcast) &&
        'undefined' !== typeof(Callcast.log)) {
      Callcast.log(' ' + labels[logLevel] + ': ' + logMsg);
    }
    // </MANJESH>
  }, /* app.log() */
  /**
   * Flag to remember if a fatal error was reported through a pop-up
   * alert previously so we can avoid pop-up flooding. */
  logFatalReported: false,

  nickInUse: function(nick) {
  	log(2, "Nick in use.");
  },
}; /* app */

function onConnectionStatus(statusStr)
{
	alert("onConnectionStatus(" + statusStr + ")");
	app.log(2, 'connectionStatus' + statusStr);

Callcast.SetNickname('iOSClient');
}

function onNicknameInUse(nick)
{
	alert("onNicknameInUse(" + nick + ")");
	app.nickInUse(nick);
}

function assignSpotForParticipant(nick)
{
	alert("assignSpotForParticipant(" + nick + ")");
}

function unassignSpotForParticipant(nick)
{
	alert("unassignSpotForParticipant(" + nick + ")");
}

function onAddSpot(data)
{
	alert("onAddSpot(" + data + ")");
}

function onRemoveSpot(data)
{
	alert("onRemoveSpot(" + data + ")");
}

function tjgsend()
{
    Callcast.InitOverride({ CALLCAST_XMPPSERVER: 'dev.gocast.it',
                        CALLCAST_ROOMS: 'conference.dev.gocast.it',
                        AT_CALLCAST_ROOMS: '@conference.dev.gocast.it',
                        STUNSERVER: 'dev.gocast.it', STUNSERVERPORT: 19302,
                        FEEDBACK_BOT: 'feedback_bot_dev@dev.gocast.it',
                        ROOMMANAGER: 'roommanager@dev.gocast.it/roommanager',
                        SWITCHBOARD_FB: 'switchboard_dev@dev.gocast.it',
                        LOGCATCHER: 'logcatcher@dev.gocast.it/logcatcher',
                        FILECATCHER: 'filecatcher@dev.gocast.it/filecatcher'});

Callcast.connect(Callcast.CALLCAST_XMPPSERVER, '');

Callcast.setCallbackForCallback_ConnectionStatus(onConnectionStatus);
Callcast.setCallbackForCallback_OnNicknameInUse(onNicknameInUse);
Callcast.setCallbackForAddSpotForParticipant(assignSpotForParticipant);
Callcast.setCallbackForRemoveSpotForParticipant(unassignSpotForParticipant);
Callcast.setCallbackForAddSpot(onAddSpot);
Callcast.setCallbackForRemoveSpot(onRemoveSpot);

// Callcast.log("This is a test message.");
// 
// // var logQ = new GoCastJS.BQueue(1024*1024);
// // logQ.log("tjg test message");
// 
// //alert(Callcast.LOGCATCHER);
// 
// //GoCastJS.SendLogsXMPP = function(room, nick, logcatcher, id, pw, cbSuccess, cbFailure, url) {
// 
//     var logger = new GoCastJS.SendLogsXMPP('tjg1', 'tjg2',
// 											Callcast.LOGCATCHER,
// 											Callcast.CALLCAST_XMPPSERVER, '',
// 											function() {
// 												console.log('success callback');
// 											}, function() {
// 												console.log('failure callback');
// 											}, 'http://dev.gocast.it/xmpp-httpbind');
}

setTimeout(function() { tjgsend() }, 2000);
</script>
</body>
</html>
